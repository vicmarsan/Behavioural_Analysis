library(HMM)

states <- c("Heading odor","Heading bottom","Opposite to odor","Heading top")

startProb = c(0.27014634821190353, 0.21427512673300592, 0.2519392867377491, 0.26363923831734143)

HoProb <- c(0.8927134391689224, 0.04565074255614895, 0.006419635671958446, 0.055216182602970225)
HbProb <- c(0.057024926787649595, 0.8807157516083658, 0.05499573408351973, 0.007263587520464869)
OoProb <- c(0.006628620736992803, 0.04730246514090722, 0.893510619521092, 0.05255829460100802)
HtProb <- c(0.05723495567758016, 0.004985100920182162, 0.0504882025525216, 0.8872917408497161)

transProb <- t(matrix(c(HoProb, HbProb, OoProb, HtProb),4))

elements <- c(225:360,0:224)

HoStateProb <- c(0.01340625, 0.01192479, 0.01218085, 0.01336967, 0.01289414,
                 0.01256493, 0.01252835, 0.01293072, 0.01234545, 0.01285756,
                 0.0120894 , 0.0127844 , 0.01265638, 0.01346112, 0.01309533,
                 0.01315019, 0.01320506, 0.01316848, 0.0129673 , 0.0126198 ,
                 0.01274782, 0.0124369 , 0.0129673 , 0.01304046, 0.01373546,
                 0.01230887, 0.01251006, 0.01238203, 0.01263809, 0.01218085,
                 0.01302217, 0.01293072, 0.01232716, 0.01210769, 0.01181506,
                 0.0126198 , 0.01176019, 0.01077255, 0.01128466, 0.01282098,
                 0.01119321, 0.01238203, 0.0113944 , 0.01186992, 0.0120894 ,
                 0.01113834, 0.01084571, 0.01101032, 0.010169  , 0.01073597,
                 0.0099861 , 0.01027873, 0.01020557, 0.01112005, 0.01095545,
                 0.01004097, 0.010169  , 0.01097374, 0.01077255, 0.01027873,
                 0.01053479, 0.01082742, 0.01044334, 0.01082742, 0.01015071,
                 0.0099861 , 0.0099861 , 0.0094557 , 0.0103336 , 0.00896188,
                 0.00901675, 0.00949228, 0.00907162, 0.00958373, 0.00899846,
                 0.00898017, 0.00844978, 0.00898017, 0.00865096, 0.00923623,
                 0.00870583, 0.00868754, 0.0084132 , 0.00799254, 0.00843149,
                 0.00844978, 0.00854122, 0.00907162, 0.00854122, 0.00898017,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.       )
HbStateProb <- c(0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.00530345, 0.01076831, 0.01051467, 0.01111419, 0.01092972,
                 0.01106807, 0.01035326, 0.00961538, 0.00915422, 0.01122948,
                 0.01166759, 0.01067607, 0.01208264, 0.01120642, 0.01157536,
                 0.01171371, 0.01139089, 0.01166759, 0.01159841, 0.01196735,
                 0.01159841, 0.01164453, 0.01118336, 0.01233628, 0.01129865,
                 0.01240546, 0.01185206, 0.01199041, 0.01358144, 0.01268216,
                 0.01235934, 0.01224405, 0.01263605, 0.01268216, 0.01231323,
                 0.01307416, 0.01235934, 0.01325862, 0.01302804, 0.01321251,
                 0.01358144, 0.01275134, 0.01224405, 0.01233628, 0.01420402,
                 0.01049161, 0.0103302 , 0.01120642, 0.00977679, 0.01208264,
                 0.01069913, 0.0103302 , 0.01157536, 0.01099889, 0.01102195,
                 0.01039937, 0.01026102, 0.01106807, 0.01081443, 0.01067607,
                 0.00973068, 0.01046855, 0.01076831, 0.00963844, 0.0103302 ,
                 0.00970762, 0.01053772, 0.0096615 , 0.01067607, 0.01003044,
                 0.00998432, 0.01044549, 0.01058384, 0.01014573, 0.01083748,
                 0.00933868, 0.00996126, 0.01044549, 0.00968456, 0.01042243,
                 0.00986903, 0.00996126, 0.00959233, 0.00973068, 0.01051467,
                 0.01035326, 0.01053772, 0.00963844, 0.01016879, 0.01056078,
                 0.00548792, 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        )
OoStateProb <- c(0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.01021749, 0.01141378, 0.01104116, 0.01078622,
                 0.01100194, 0.01133533, 0.01086466, 0.01159028, 0.01051166,
                 0.01029593, 0.0112765 , 0.01151184, 0.01045283, 0.01139417,
                 0.01037438, 0.01151184, 0.01121767, 0.0111    , 0.01135494,
                 0.01100194, 0.01102155, 0.01166873, 0.01053127, 0.01227668,
                 0.01245318, 0.01272774, 0.01280618, 0.01206095, 0.01198251,
                 0.01290424, 0.01237473, 0.01304152, 0.01166873, 0.01184523,
                 0.01223745, 0.01170795, 0.01159028, 0.01082544, 0.01208056,
                 0.01151184, 0.01139417, 0.0121394 , 0.01094311, 0.01064894,
                 0.01125689, 0.01004099, 0.01062933, 0.01108039, 0.01070777,
                 0.01021749, 0.01035477, 0.01102155, 0.01017827, 0.01082544,
                 0.0104136 , 0.01019788, 0.01078622, 0.01117844, 0.01115883,
                 0.01047244, 0.01166873, 0.01106078, 0.01084505, 0.01157067,
                 0.01104116, 0.01164911, 0.01084505, 0.01086466, 0.01055088,
                 0.01102155, 0.01188445, 0.01178639, 0.01202173, 0.0111    ,
                 0.01072738, 0.01117844, 0.01151184, 0.01013904, 0.01062933,
                 0.01060972, 0.01000177, 0.00968798, 0.0109235 , 0.00949187,
                 0.01123728, 0.00904081, 0.01031555, 0.01117844, 0.00982526,
                 0.01037438, 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.         )
HtStateProb <- c(0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.        , 0.        , 0.        , 0.        ,
                 0.        , 0.00920182, 0.01012013, 0.01053243, 0.00927679,
                 0.0095579 , 0.0092393 , 0.00920182, 0.0103825 , 0.00912686,
                 0.01045747, 0.00961412, 0.00980153, 0.01053243, 0.01010139,
                 0.01013887, 0.00901441, 0.00957664, 0.0094642 , 0.00942671,
                 0.00961412, 0.01008265, 0.00912686, 0.00978279, 0.00965161,
                 0.00938923, 0.01066362, 0.01017635, 0.00967035, 0.01085103,
                 0.01081355, 0.01055117, 0.00957664, 0.01115088, 0.01088851,
                 0.01006391, 0.01025132, 0.01053243, 0.01006391, 0.01120711,
                 0.01043873, 0.01015761, 0.01160067, 0.011432  , 0.0106074 ,
                 0.01096347, 0.01130081, 0.01083229, 0.01199423, 0.01190052,
                 0.01148822, 0.01062614, 0.01158193, 0.01090725, 0.01163815,
                 0.01244401, 0.01238779, 0.01096347, 0.01160067, 0.01242527,
                 0.01227534, 0.01120711, 0.01158193, 0.01133829, 0.01205045,
                 0.01126333, 0.0117506 , 0.01182556, 0.0118443 , 0.01113214,
                 0.01169437, 0.01167563, 0.01201297, 0.01208793, 0.011938  ,
                 0.011938  , 0.01283757, 0.01191926, 0.01261268, 0.01321239,
                 0.0130812 , 0.01261268, 0.01304372, 0.01336232, 0.01287505,
                 0.01302498, 0.01403699, 0.01450552, 0.01272513, 0.01313743,
                 0.01323113)

emissProb <- matrix(c(HoStateProb,HbStateProb,OoStateProb,HtStateProb), 4, byrow = T) 

hmm <- initHMM(States = states, 
               Symbols = elements,
               transProbs=transProb,
               emissionProbs = emissProb)

hmm$startProbs["Heading odor"] <- startProb[1]
hmm$startProbs["Heading bottom"] <- startProb[2]
hmm$startProbs["Opposite to odor"] <- startProb[3]
hmm$startProbs["Heading top"] <- startProb[4]

print(hmm)

simhmm <- simHMM(hmm, 1000000)
simhmm_df <- as.data.frame(simhmm)
write.table(simhmm,file = "simulacion_asyn_free")

table(simhmm_df$states)

pie(table(simhmm_df$states),main = "Proportion of orientations aSyn-A53T free",
    col = c("lightgreen","lightblue","purple","lightyellow"),)

# Steady-state equations. [Ho Hb Oo Ht]*(I-transmat) = 0

I = diag(4)
matriz <- I- transProb
matriz <- t(matriz)
matriz <- rbind(matriz,c(1,1,1,1))
vector <- c(0,0,0,0,1)

round(qr.solve(matriz,vector)*100,digits = 2)

# Simulations

sim <- read.table("simulacion_asyn_free")
states_count <- table(sim$states)
percentages <- round(prop.table(states_count)*100,digits = 2)
